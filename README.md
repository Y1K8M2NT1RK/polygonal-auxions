# Polygonal Auxions
## 0. 目次
1. [概要](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#1-%E6%A6%82%E8%A6%81)
2. [実装済の機能/画面（全16点）](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#2-%E5%AE%9F%E8%A3%85%E6%B8%88%E3%81%AE%E6%A9%9F%E8%83%BD%E7%94%BB%E9%9D%A2%E5%85%A816%E7%82%B9)
3. [使用技術](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#3-%E4%BD%BF%E7%94%A8%E6%8A%80%E8%A1%93)
4. [各種操作方法（全7点）](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#4-%E5%90%84%E7%A8%AE%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95%E5%85%A87%E7%82%B9)
5. [ローカル環境でのアプリケーションの起動方法（全6点）](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#5-ローカル環境でのアプリケーションの起動方法全6点)

## 1. 概要
1. 現時点ではまだ途中段階ですが、3Dコンテンツを作品として共有するプラットフォームです。
某イラストコミュニケーションプラットフォームに似たアプリを想定して開発しています。
2025年5月18日時点ではまだ導入していませんが、将来的には下記2点の導入を予定しております。
    1. WebGLの導入
    2. 管理画面の導入

2. 下記リンクから実際にご使用いただけます。 **（レスポンシブ画面でも操作可能です。）**
    * https://polygonal-auxions.vercel.app/

[目次へ戻る](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#0-%E7%9B%AE%E6%AC%A1)

## 2. 実装済の機能/画面（全16点）
1. 機能（全10点）
    1. ログイン機能
    2. ログアウト機能
    3. 作品追加機能
    4. 作品のお気に入り追加機能
    5. 作品のお気に入り追加解除機能
    6. 作品のブックマーク機能
    7. 作品のブックマーク解除機能
    8. コメント一覧機能
    9. フォロー機能
    10. フォロー解除機能
2. 画面とその主な特徴（全6点）
    1. ホーム画面
          1. ログインの有無で画面の内容が変わります。
          2. 「検索しないで作品を見る」ボタンをクリックすると作品一覧画面へ遷移できます。
    3. 作品一覧画面
          1. お気に入り追加機能とブックマーク機能が使用できます。
          2. 新しい順に作品のデータが並んでいます。    
          3. 各作品の上側にあるユーザのアイコン、もしくはその隣のユーザネームをクリックすると、その作品のユーザのプロフィール画面に遷移できます。
          4. 作品名の上にある大きな囲いをクリックすると、その作品の作品詳細画面に遷移できます。
    4. 作品詳細画面
          1. お気に入り追加機能とブックマーク機能が使用できます。
          2. 各作品の上側にあるユーザのアイコン、もしくはその隣のユーザネームをクリックすると、その作品のユーザのプロフィール画面に遷移できます。
          3. 作品に対するコメントが閲覧できます。
    5. 作品追加画面
          1. 作品名と説明文を両方入力することで作品が追加できます。
    6. ユーザのプロフィール画面
          1. ログイン中のユーザ以外の場合は、フォロー/フォロー解除機能が使用できます。
          2. その画面と紐づくユーザの作品やコメントが閲覧できます。
3. 各機能の操作方法については「4. 各種操作方法（全7点）」をご覧ください。

[目次へ戻る](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#0-%E7%9B%AE%E6%AC%A1)

## 3. 使用技術
* フロントエンド：Next.js、URQL
* サーバーサイド：GraphQL Yoga, Pothos
* CSS：MUI
* DB：PostgreSQL
* 言語：TypeScript
* その他：Docker, Vercel

[目次へ戻る](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#0-%E7%9B%AE%E6%AC%A1)

## 4. 各種操作方法（全7点）
### 1. 注意
* **もし操作した結果が反映されない場合は、お手数ですが画面の再読込をしていただきますようお願いいたします。**
### 2. 操作方法
1. ログイン
    1. 「ログイン」ボタンをクリック
    2. 下記の情報を入力する
        * メールアドレス： `aaa@example.jp`
        * パスワード： `0000`
    3. Enterキーもしくは「ログイン」ボタンをクリック
    4. 右上の「＋」ボタンとユーザアイコンボタンが表示出来たら成功
2. ログアウト
    1. ※1の操作を行ってから進めてください
        * ∵ログインしていない状態だとログアウトボタンが表示されないため
    2. 右上のユーザアイコンボタン（「＋」ボタンの右隣）をクリック
    3. ログアウトボタンをクリック
    4. 「ログイン」ボタンが表示出来たらログアウト成功
3. 作品の追加
    1. ※1の操作を行ってから進めてください
        * ∵ログインしていない状態だと「＋」ボタンが表示されないため
    2. 「＋」ボタンをクリックし、作品追加画面を開く
    3. 「作品名」と「説明文」を入れる
    4. 「追加」ボタンをクリック
    5. 作品一覧画面に遷移され、入力した作品名と説明文が表示出来たら成功
4. お気に入りに追加/ブックマーク
    1. ※1の操作を行ってから進めてください
        * ∵ログインしていない状態だと、エラーが表示されるため
    2. 作品一覧画面を開く
        * ※作品一覧画面URL：https://polygonal-auxions.vercel.app/artworks
    3. 下記のいずれかのボタンをクリック
        1. お気に入り：赤線のみのハートマーク
        2. ブックマーク：青線のみのしおり
    4. 上記操作の結果、下記のいずれかの通りに表示出来たら成功
        1. お気に入り：赤塗りのハートマーク
        2. ブックマーク：青塗りのしおり
    5. ※もしクリックしても赤塗り/青塗りにならない場合は、お手数ですがブラウザリロードをお願いします。
5. お気に入りに追加/ブックマークの解除
    1. ※1→4の順に操作を行ってから進めてください
        * ∵ログインかつお気に入りに追加/ブックマークしていない※状態だと、それらの解除ボタンが表示されないため
            * ※お気に入りに追加/ブックマークしていない：いずれも線のみの状態
    2. 作品一覧画面を開く
        * ※作品一覧画面URL：https://polygonal-auxions.vercel.app/artworks/
    3. 下記のいずれかのボタンをクリック
        1. お気に入り：赤塗りのハートマーク
        2. ブックマーク：青塗りのしおり
    4. 上記操作の結果、下記のいずれかの通りに表示出来たら成功
        1. お気に入り：赤線のみのハートマーク
        2. ブックマーク：青線のみのしおり
    5. ※もしクリックしても線のみにならない場合は、お手数ですがブラウザリロードをお願いします。
6. ユーザーのフォロー
    1. ※1の操作を行ってから進めてください
        * ∵ログインしていない状態だと、エラーが表示されるため
    2. 作品一覧画面を開く
        * ※作品一覧画面URL：https://polygonal-auxions.vercel.app/artworks/
    3. 各作品の上側にあるユーザのアイコン、もしくはその隣のユーザネームをクリックし、フォローしていない※ユーザのプロフィール画面を開く
        1. ※フォローしていない：「フォロー」ボタンが表示されている状態
        2. ※フォロー中のユーザであれば、お手数ですが一度作品一覧へ戻っていただき、別のフォローしていないユーザに対して上記操作をもう一度行うようお願いします。
            * ※フォロー中：「フォロー解除」ボタンが表示されている状態
    4. 「フォロー」ボタンをクリック
    5. 「フォロー解除」ボタンが表示出来たら成功
7. ユーザーのフォロー解除
    1. ※1→6の順に操作を行ってから進めてください
        * ∵ログインかつフォローしていない※状態だと、「フォロー解除」ボタンが表示されないため
            * ※フォローしていない：「フォロー」ボタンが表示されている状態
    2. 作品一覧画面を開く
        * ※作品一覧画面URL：https://polygonal-auxions.vercel.app/artworks/
    3. フォロー中※のユーザのプロフィール画面を開く
        1. ※フォロー中：「フォロー解除」ボタンが表示されている状態
        2. ※フォローしていないユーザであれば、お手数ですが一度作品一覧へ戻っていただき、別のフォロー中のユーザに対して上記操作をもう一度行うようお願いします。
            * ※フォローしていない：「フォロー」ボタンが表示されている状態
            * ※作品一覧画面URL：https://polygonal-auxions.vercel.app/artworks/
    4. 「フォロー解除」ボタンをクリック
    5. 「フォロー」ボタンが表示出来たら成功

[目次へ戻る](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#0-%E7%9B%AE%E6%AC%A1)

## 5. ローカル環境でのアプリケーションの起動方法（全6点）
### 1. 注意
1. **Ubuntu/WSLでのコマンド操作を想定しております。**
2. **DockerとNode/npmがインストールされていない場合は、お手数ですがインストールしていただきますようお願いいたします。**
### 2. 操作手順
1. Gitのクローン
```
git clone https://github.com/Y1K8M2NT1RK/polygonal-auxions.git
```

2. プロジェクトのディレクトリへ移動
```
cd ./polygonal-auxions/
```

3. dockerコンテナのビルド/起動
```
docker compose up -d --build
```

4. 起動中のコンテナを確認
```
docker ps
```

5. ここまで操作したら、また約1,2分後に[http://localhost:3001/](http://localhost:3001/)をブラウザのURLに入力してEnterキーを押下
    * ※なお、下の画像の画面が開いてしまった場合は、お手数ですが約1,2分後に下記のいずれかの方法で対処をお願いします。
        1. ブラウザリロード（再読み込み）
        2. URL入力部分をクリックしてもう一度Enterキーを押す
    * ![スクリーンショット 2025-03-05 154740](https://github.com/user-attachments/assets/3d34dffc-1d86-4d57-ab9f-faf021ba5c86)

6. 下の画像の画面が開いたら起動に成功
    * ![スクリーンショット 2025-02-18 151619](https://github.com/user-attachments/assets/56733872-b8b7-4b89-9c48-841a03547464)

[目次へ戻る](https://github.com/Y1K8M2NT1RK/polygonal-auxions?tab=readme-ov-file#0-%E7%9B%AE%E6%AC%A1)

## 6. デプロイ (手動運用方針)
自動デプロイを無効化し、明示操作のみで Vercel へ反映します。

### 1. 前提
`vercel.json` に `"git": { "deploymentEnabled": false }` を設定済み (push でデプロイされません)。

### 2. Preview デプロイ
```
npm ci
npx prisma generate
npx graphql-codegen
npm run build
npx vercel --prebuilt --confirm
```

### 3. Production デプロイ
```
npm ci
npx prisma generate
npx graphql-codegen
npm run build
npx vercel deploy --prod --prebuilt --confirm
```

### 4. 推奨ワークフロー
1. main ブランチへ merge
2. Preview デプロイで動作確認
3. 問題なければ Production デプロイ

### 5. 失敗時リカバリ
Vercel ダッシュボード > Deployments で前回 Production を Promote することで即座にロールバック可能。

### 6. バンドル最適化メモ (Tree Shaking)
- modularizeImports 設定で `@mui/material` / `@mui/icons-material` を個別 import 化
- package.json `sideEffects` で未使用コード削減を支援 (CSS は副作用扱いで除外)
- 不要になった一括 import を書かない: `import Button from '@mui/material/Button'` または `import { Button } from '@mui/material'`

